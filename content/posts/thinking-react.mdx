---
title: Building React - Color Picker Component
date: 2019-12-04
---

import { CodeWave } from "gatsby-theme-waves"
import {ColorPicker} from "../../src/components/ColorPicker"

*By Danine Noble and David Bergeron*


Hello, My name is David, and that other author over there is Danine. 
Together, we are going to be breaking down and building a React component. On the
menu today we have everyone's favorite UI widget: **The Color Picker**.

Here's the plan:

1. First, we're going to pull apart all the little pieces that you find in a color picker.
2. Then, piece by piece, we're going to build the component.
3. Last, but certainly not least we will pick some *groovy* colors.


<CodeWave>

```jsx
const ColorPicker = ({ width, height }) => {
  
  return (
    <>
      <div style={{ display: "flex" }}>
        <Map
          width={width}
          height={height}
          bgColor={`hsl(${sliderVal}, 100%, 50%)`}
          dragging={movePointer}
        />
        <Slider value={sliderVal} setValue={setSliderVal} height={height} />
      </div>

      <ColorDisplay color={color} />
    </>
  )
}
```

## The Pieces

To get us started we broke down a simple color picker into 3 components: the Map, Slider, and Display. Our main ColorPicker app wraps them all up. We'll dive into those in a moment.

First, let's look at ColorPicker.

```js 2:4
const ColorPicker = ({ width, height }) => {
  const [sliderVal, setSliderVal] = useState(150)
  const [pointPos, setPointPos] = useState([width / 2, height / 2])
  const [color, setColor] = useState(tinycolor())

  return (
    <>
      <div style={{ display: "flex" }}>
        <Map
          width={width}
          height={height}
          bgColor={`hsl(${sliderVal}, 100%, 50%)`}
          dragging={movePointer}
        />
        <Slider value={sliderVal} setValue={setSliderVal} height={height} />
      </div>

      <ColorDisplay color={color} />
    </>
  )
}
```

ColorPicker has 3 lifted states:

- sliderVal: the hue determined by Slider
- pointPos: the position of the pointer on the Map
- color: the final color value derived from the pointer position and hue

```js 2,12,15
const ColorPicker = ({ width, height }) => {
  const [sliderVal, setSliderVal] = useState(150)
  const [pointPos, setPointPos] = useState([width / 2, height / 2])
  const [color, setColor] = useState(tinycolor())
  
  return (
    <>
      <div style={{ display: "flex" }}>
        <Map
          width={width}
          height={height}
          bgColor={`hsl(${sliderVal}, 100%, 50%)`}
          dragging={movePointer}
        />
        <Slider value={sliderVal} setValue={setSliderVal} height={height} />
      </div>

      <ColorDisplay color={color} />
    </>
  )
}
```

SliderVal is set by the Slider component, which then gets passed to the Map and sets its background color.

```js 3,6:8,17
const ColorPicker = ({ width, height }) => {
  const [sliderVal, setSliderVal] = useState(150)
  const [pointPos, setPointPos] = useState([width / 2, height / 2])
  const [color, setColor] = useState(tinycolor())

  const movePointer = (x, y) => {
    setPointPos([x, y])
  }
  
  return (
    <>
      <div style={{ display: "flex" }}>
        <Map
          width={width}
          height={height}
          bgColor={`hsl(${sliderVal}, 100%, 50%)`}
          dragging={movePointer}
        />
        <Slider value={sliderVal} setValue={setSliderVal} height={height} />
      </div>

      <ColorDisplay color={color} />
    </>
  )
}
```

The position of the pointer is lifted up from the Map component.

```js 4,10:25,39
const ColorPicker = ({ width, height }) => {
  const [sliderVal, setSliderVal] = useState(150)
  const [pointPos, setPointPos] = useState([width / 2, height / 2])
  const [color, setColor] = useState(tinycolor())

  const movePointer = (x, y) => {
    setPointPos([x, y])
  }

  useEffect(() => {
    function updateColor() {
      const [xPos, yPos] = pointPos

      const h = sliderVal
      const s = xPos / width
      const v = 1 - parseFloat(yPos) / (height - 1)

      const c = tinycolor({ h, s, v })
      setColor(c)
    }

    if (color) {
      updateColor()
    }
  }, [sliderVal, pointPos, width, height])
  
  return (
    <>
      <div style={{ display: "flex" }}>
        <Map
          width={width}
          height={height}
          bgColor={`hsl(${sliderVal}, 100%, 50%)`}
          dragging={movePointer}
        />
        <Slider value={sliderVal} setValue={setSliderVal} height={height} />
      </div>

      <ColorDisplay color={color} />
    </>
  )
}
```

And finally, color. This is updated with an effect hook watching for changes in the hue, pointer position, or map a resize, which is then passed into Color Display to output the various output values.

Now let's dive a little deeper into each component.

```js
const Slider = ({ value, setValue, height }) => {
  const handleChange = e => {
    setValue(e.target.value)
  }

  let origin = height / 2 - 5

  return (
    <div className="slider-wrapper">
      <input
        type="range"
        id="range"
        min="0"
        max="360"
        step="1"
        value={value}
        onChange={handleChange}
        style={{ width: height, transformOrigin: `${origin}px ${origin}px` }}
      />
    </div>
  )
}
```

## The Slider Component

*stuffs*

```js
const Map = ({ width, height, bgColor, dragging }) => {
  return (
    <div className="map" style={{ width, height }}>
      <div className="color-bg" style={{ backgroundColor: bgColor }}>
        <div className="overlay" />
      </div>
      <Draggable
        bounds="parent"
        defaultPosition={{ x: width / 2, y: height / 2 }}
        onDrag={(e, data) => dragging(data.x, data.y)}
      >
        <div className="pointer"></div>
      </Draggable>
    </div>
  )
}
```

## The Map Component

*stuffs*

```js
const ColorDisplay = ({ color }) => {
  if (color) {
    let hex = color.toHexString()
    let hsl = color.toHslString().slice(4, -1)
    let rgb = color.toRgb()

    return (
      <div className="color-display">
        <div className="color-preview" style={{ backgroundColor: hex }}></div>
        <div>
          <div>HEX</div> {hex}
        </div>
        <div>
          <div>RGB</div>
          {rgb["r"]}, {rgb["g"]}, {rgb["b"]}
        </div>
        <div>
          <div>HSL</div>
          {hsl}
        </div>
      </div>
    )
  } else {
    return null
  }
}
```

## The Color Display Component
*stuffs*

</CodeWave>

Of course this project wouldn't be complete without the final color picker.

<ColorPicker width={627} height={300} />

*This project has been built with [Gatsby JS](https://www.gatsbyjs.org/) using the theme: [Gatsby Waves](https://www.gatsbyjs.org/packages/gatsby-theme-waves/).
 If you're interested in how we put it all together you can [check out our code on github](https://github.com/SceptreData/double-d-react). *